---
import PageLayout from '../layouts/BaseLayout.astro'
import Section from '../components/Section.astro'
import Card from '../components/Card.astro'
import ProjectCard from '../components/ProjectCard.astro'
import Label from '../components/Label.astro'
import SkillLayout from '../components/SkillLayout.astro'
import PostPreview from '@/components/blog/PostPreview.astro'

import { Image } from 'astro:assets'
import astro from '../assets/profile_pixel.jpg'

import { getAllPosts, sortMDByDate } from '@/utils'

const programming = ['Python', 'Typescript', 'Rust', 'Git', 'Linux', 'Rest API']
const data = [
	'SQL',
	'Airflow',
	'Snowflake/Redshift',
	'PostgreSQL',
	'Kafka',
	'Redis',
	'Object Stores',
	'GenAI'
]
const devops = ['Docker', 'Kubernetes', 'Grafana/Prometheus Stack', 'CI/CD (Jenkins)', 'AWS/GCP']

const MAX_POSTS = 10
const allPosts = await getAllPosts()
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)
---

<PageLayout meta={{ title: 'Home' }}>
	<div class='flex w-full flex-col gap-y-10'>
		<section class='flex flex-col items-center gap-y-7'>
			<Image src={astro} alt='profile photo' class='h-48 w-auto rounded-3xl p-1' loading='eager' />

			<div class='flex flex-col items-center gap-y-4'>
				<h1 class='text-3xl font-bold'>Jonathan Wang</h1>
				<div class='flex flex-wrap justify-center gap-x-7 gap-y-3'>
					<Label title='Data Engineer'>
						<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' class='h-5 w-5' slot='icon'
							><path
								fill='currentColor'
								d='M4.615 20q-.69 0-1.152-.462Q3 19.075 3 18.385v-9.77q0-.69.463-1.152Q3.925 7 4.615 7H9V5.615q0-.69.463-1.152Q9.925 4 10.615 4h2.77q.69 0 1.153.463q.462.462.462 1.152V7h4.385q.69 0 1.152.463q.463.462.463 1.152v9.77q0 .69-.462 1.152q-.463.463-1.153.463zm0-1h14.77q.23 0 .423-.192q.192-.193.192-.423v-9.77q0-.23-.192-.423Q19.615 8 19.385 8H4.615q-.23 0-.423.192Q4 8.385 4 8.615v9.77q0 .23.192.423q.193.192.423.192M10 7h4V5.615q0-.23-.192-.423Q13.615 5 13.385 5h-2.77q-.23 0-.423.192q-.192.193-.192.423zM4 19V8z'
							></path></svg
						>
					</Label>
					<Label title='London, UK'>
						<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' class='h-5 w-5' slot='icon'
							><path
								fill='currentColor'
								d='M12.003 11.73q.668 0 1.14-.475q.472-.475.472-1.143t-.475-1.14q-.476-.472-1.143-.472t-1.14.476q-.472.475-.472 1.143t.475 1.14q.476.472 1.143.472M12 19.677q2.82-2.454 4.458-4.991q1.638-2.538 1.638-4.39q0-2.744-1.737-4.53T12 3.981q-2.621 0-4.359 1.785t-1.737 4.53q0 1.852 1.638 4.39q1.639 2.537 4.458 4.99m0 1.343q-3.525-3.117-5.31-5.814q-1.786-2.697-1.786-4.909q0-3.173 2.066-5.234Q9.037 3 12 3t5.03 2.062q2.066 2.061 2.066 5.234q0 2.212-1.785 4.909q-1.786 2.697-5.311 5.814m0-10.904'
							></path></svg
						>
					</Label>
					<Label
						title='Linkedin'
						as='a'
						href='https://www.linkedin.com/in/jonathan-wang-nz/'
						target='_blank'
					>
						<svg
							xmlns='http://www.w3.org/2000/svg'
							viewBox='0 0 16 16'
							slot='icon'
							class='h-5 w-5 text-foreground/75'
							><path
								fill='currentColor'
								d='M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854zm4.943 12.248V6.169H2.542v7.225zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248c-.015-.709-.52-1.248-1.342-1.248S2.4 3.226 2.4 3.934c0 .694.521 1.248 1.327 1.248zm4.908 8.212V9.359c0-.216.016-.432.08-.586c.173-.431.568-.878 1.232-.878c.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252c-1.274 0-1.845.7-2.165 1.193v.025h-.016l.016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225z'
							></path></svg
						>
					</Label>
					<Label title='GitHub' as='a' href='https://github.com/Jonnowang' target='_blank'>
						<svg
							xmlns='http://www.w3.org/2000/svg'
							viewBox='0 0 16 16'
							slot='icon'
							class='h-5 w-5 text-foreground/75'
							><path
								fill='currentColor'
								d='M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z'
							></path></svg
						>
					</Label>
				</div>
			</div>
		</section>

		{
			allPostsByDate.length > 0 && (
				<Section title='Posts'>
					<ul class='flex flex-col gap-y-2'>
						{allPostsByDate.map((p) => (
							<li class='flex flex-col gap-x-2 sm:flex-row'>
								<PostPreview post={p} />
							</li>
						))}
					</ul>
				</Section>
			)
		}

		<Section title='Experience'>
			<Card
				heading='Marshall Wace'
				subheading='Data Engineer'
				date='Apr 2024 - Present'
				imagePath='/src/assets/mwam.jpg'
				altText='Marshall Wace'
				imageClass='h-16 w-auto md:-left-20'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						<b
							>Reduced the latency of the central authentication API by 100x from 5s to 50ms P95
							response time.</b
						> Built an API layer that reconstructed and cached the Active Directory graph with a sharded
						Redis cluster to reduce recursive search space and remove redundant calls.
					</li>
					<li>
						Built an index rebalance insight parser leveraging generative LLMs. Articles were
						converted from unstructured HTML to JSON with correctness and schema validation stages. <b
							>Delivered structured insights to quant teams databases within seconds of article
							publication.</b
						>
					</li>
				</ul>
			</Card>
			<Card
				heading='Smarkets'
				subheading='Data Engineer & Scientist'
				date='Sep 2022 - Apr 2024'
				imagePath='/src/assets/smarkets.jpg'
				altText='smarkets'
				imageClass='h-16 w-auto md:-left-20'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						Developed an industry-leading recommendation engine. Processed user activity data in an
						implicit matrix factorisation model; hyperparameter tuning was done using a custom
						metric suite. A/B testing revealed a <b>40% increase in engagement</b> compared to unpersonalised
						events.
					</li>
					<li>
						Implemented an asynchronous Python job using Kafka which loaded archived S3 files
						without severe I/O bottlenecking for trading backtesting. New system <b
							>reduced processing time for terabytes of CSV data to 12 minutes per day</b
						> of data, down from 2 hours previously.
					</li>
					<li>
						Worked closely with internal DevOps team to migrate Rust and Nix pricing engine data
						systems from outdated infrastructure to a unified architecture. <b
							>Reduced the engineering maintenance effort by 50%</b
						> due to unified code architecture.
					</li>
				</ul>
			</Card>
			<Card
				heading='HomeX'
				subheading='Applied Data Science Intern'
				date='Jun 2021 - Sep 2021'
				imagePath='/src/assets/homex.jpg'
				altText='homex'
				imageClass='h-16 w-auto md:-left-20'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						Built a backend API using Python's FastAPI serving a regression model to 5 other
						internal services.
					</li>
					<li>
						Built a frontend BI data visualisation dashboard using TypeScript and React with
						interactive street maps and tables.
					</li>
				</ul>
			</Card>
		</Section>

		<Section title='Education'>
			<Card
				heading='Univeristy of Cambridge'
				subheading='M.ENG (Hons), Computer and Information Engineering'
				date='Oct 2018 - Jun 2022'
				imagePath='/src/assets/cam.jpg'
				altText='Cambridge'
				imageClass='h-16 w-auto md:-left-20'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>Graduated Honours with Distinction (1st Class thesis & 1st Class exam results).</li>
					<li>
						First Year: 74% ; Second Year: Ungraded (As a result of CoVid-19) ; Third Year: 71% ;
						Fourth Year: 72.5%.
					</li>
					<li>
						Masters Thesis: Developed a large language model that could respond to hate speech using
						a novel evaluation suite and custom data. Modified cutting edge models such as Blender
						Bot & GPT-3 to achieve superior performance. Training was done on HPC clusters.
					</li>
				</ul>
			</Card>
		</Section>

		<Section title='Skills'>
			<SkillLayout title='Programming' skills={programming} />
			<SkillLayout title='Data' skills={data} />
			<SkillLayout title='DevOps' skills={devops} />
		</Section>

		<Section title='Projects'
			><Card
				heading='Conference for Truth and Trust Online'
				subheading='Featured Speaker'
				date='Oct 2022'
				imagePath='/src/assets/tto.jpg'
				altText='conference'
				imageClass='h-16 w-auto md:-left-20'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						Gave an on-stage presentation to a 100+ person audience regarding the novel technical
						contributions to LLM research based on my Master's thesis.
						(https://truthandtrustonline.com/)
					</li>
				</ul>
			</Card>
			<!-- <div class='flex flex-col gap-y-3 sm:flex-row sm:gap-x-3 sm:gap-y-0'>
				<ProjectCard
				href='https://www.google.com'
				heading='Card Test'
				subheading='123'
				imagePath='/src/assets/profile_pixel.jpg'
				altText='Example'
				class='w-full sm:w-1/2'
				/>
			</div> -->
		</Section>
	</div>
</PageLayout>
